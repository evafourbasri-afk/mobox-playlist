name: ğŸ¥ M3U Scraper (ngefil.py)

# Menentukan kapan workflow ini akan berjalan
on:
  # Opsi 1: Jalankan secara manual dari tab Actions di GitHub
  workflow_dispatch:
  # Opsi 2: Jalankan setiap hari pada pukul 02:00 UTC (Waktu Server GitHub)
  schedule:
    - cron: '0 2 * * *' 
  # Opsi 3: Jalankan setiap kali ada perubahan yang digabungkan ke branch utama (opsional)
  # push:
  #   branches: [ main ]

jobs:
  scrape_and_update:
    runs-on: ubuntu-latest
    
    # Timeout agar workflow tidak berjalan terlalu lama jika ada masalah
    timeout-minutes: 30 

    steps:
    - name: â¬‡ï¸ Checkout Repository
      uses: actions/checkout@v4

    - name: âš™ï¸ Set up Python Environment
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'
        cache: 'pip' # Mempercepat instalasi dependensi
    
    # --- Pemasangan Dependensi ---
    
    - name: ğŸ“¦ Install Python Dependencies
      run: |
        echo "Installing required Python libraries..."
        pip install requests beautifulsoup4 playwright
        
        echo "Installing Chromium browser for Playwright..."
        # Playwright harus menginstal browser untuk dijalankan
        playwright install chromium
    
    # --- Eksekusi Skrip ---

    - name: ğŸš€ Run Python Scraper Script
      # Menjalankan skrip ngefil.py
      run: python ngefil.py

    # --- Penyimpanan Hasil ---

    - name: ğŸ’¾ Commit and Push M3U File
      uses: stefanzweifel/git-auto-commit-action@v5
      with:
        commit_message: "ğŸ¤– Update M3U Playlist: ngefilm.m3u (Automated Scrape)"
        files: ngefilm.m3u # File output yang dibuat oleh ngefil.py
        branch: main 
        # Pengaturan untuk penulis commit
        commit_user_name: GitHub Actions Bot
        commit_user_email: actions@github.com
