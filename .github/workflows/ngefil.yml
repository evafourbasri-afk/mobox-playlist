name: ğŸ¥ M3U Scraper

# Menentukan kapan workflow ini akan berjalan
on:
  # Jalankan secara manual (untuk testing)
  workflow_dispatch:
  # Jalankan setiap hari pukul 02:00 UTC
  schedule:
    - cron: '0 2 * * *'

# Mendefinisikan variabel lingkungan yang akan digunakan
env:
  CONFIG_FILE_PATH: /home/runner/steramest2data_file.txt
  
jobs:
  scrape_and_update:
    runs-on: ubuntu-latest

    steps:
    - name: â¬‡ï¸ Checkout Repository
      uses: actions/checkout@v4

    - name: âš™ï¸ Set up Python Environment
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'
        cache: 'pip'
    
    # --- Pemasangan Dependensi ---
    
    - name: ğŸ“¦ Install Python Dependencies
      run: |
        pip install requests beautifulsoup4
        pip install playwright
        playwright install chromium
    
    # --- Penyiapan File Konfigurasi (PENTING) ---
    # File ini harus berada di direktori home runner untuk diakses oleh skrip
    - name: ğŸ“ Create Config File (steramest2data_file.txt)
      run: |
        cat << EOF > $CONFIG_FILE_PATH
        BASE_URL=${{ secrets.BASE_URL }}
        ref=${{ secrets.BASE_URL }}
        UNIVERSAL_DOMAINS=${{ secrets.UNIVERSAL_DOMAINS }}
        EOF

    # --- Eksekusi Skrip ---

    - name: ğŸš€ Run Python Scraper Script
      # BARIS INI TELAH DISESUAIKAN:
      run: python ngefil.py

    # --- Penyimpanan Hasil ---

    - name: ğŸ’¾ Commit and Push M3U File
      uses: stefanzweifel/git-auto-commit-action@v5
      with:
        commit_message: "ğŸ¤– Update M3U Playlist (Automated Scrape)"
        files: ngefilm.m3u
        branch: main
